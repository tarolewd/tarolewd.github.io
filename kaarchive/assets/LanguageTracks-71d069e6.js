import{_ as V,r as m,m as R,o as v,c as f,a as s,F as y,s as S,f as M,t as b,b as L,x as w,w as j,j as I,y as U,n as $,p as C,g as N}from"./index-cc661526.js";const P=""+new URL("firstencounter/languagetracks/firstencounter-noaudio-poster.webp",import.meta.url).href,z=""+new URL("firstencounter/languagetracks/firstencounter-noaudio.mp4",import.meta.url).href;const r=p=>(C("data-v-7d0fb565"),p=p(),N(),p),A=r(()=>s("div",{class:"fs-3 text-light"},"First Encounter",-1)),B=r(()=>s("div",{class:"fs-4"},"Language Tracks",-1)),F={class:"d-flex flex-row justify-content-center flex-wrap my-1",style:{"margin-right":"-0.25rem !important","margin-left":"-0.25rem !important"}},q=["onClick"],D=["src"],O={class:"video-container"},G={class:"language-name-container"},H={class:"language-name"},X={key:0,class:"video-container-overlay"},J=r(()=>s("div",{class:"fs-4 mt-5"},"Select a language.",-1)),K=[J],Q={key:1,class:"video-container-overlay"},W={class:"fs-4 my-5"},Y={class:"language-name"},Z=r(()=>s("div",{class:"spinner-border"},null,-1)),ee={class:"mt-2 d-flex flex-row justify-content-center"},se=["href","download"],te=r(()=>s("i",{class:"bi bi-download"},null,-1)),ae=[te],ne={class:"card p-2 mb-2 d-flex flex-row"},oe=r(()=>s("span",{class:"me-1 icon-vol"},[s("i",{class:"bi bi-volume-off-fill"})],-1)),ie=r(()=>s("span",{class:"ms-1 icon-vol"},[s("i",{class:"bi bi-volume-up-fill"})],-1)),le=U('<div class="text-center" style="font-size:0.8rem;" data-v-7d0fb565><div class="alert alert-success d-inline-flex mt-2 p-2" data-v-7d0fb565><div class="me-2" data-v-7d0fb565><i class="bi bi-exclamation-circle-fill" data-v-7d0fb565></i></div><div class="flex-grow-1" data-v-7d0fb565>The audio can be slightly offset depending on the device you are using. May not work properly on iOS. </div></div></div>',1),re={__name:"LanguageTracks",setup(p){const h=m(null),t=m(null),_=m(50),l=m(-1);let d=!1,n=null;const u=new Map,x=new Set,k=["english","german","japanese","swedish","french","portuguese","spanish","dutch"].sort(),T=e=>{if(t.value===e)return;const o=d,a=h.value;if(a.pause(),n&&n.pause(),u.has(e)){const i=u.get(e);i.addEventListener("canplay",()=>{i.addEventListener("canplaythrough",()=>{t.value===e&&(o&&(a.play(),i.play()),l.value=1)},{once:!0}),u.set(e,i),t.value===e&&(l.value=1),i.currentTime=a.currentTime},{once:!0}),i.load()}else if(!x.has(e)){l.value=0;const i=new XMLHttpRequest;i.open("GET",`./assets/firstencounter/languagetracks/languages/${e}.m4a`,!0),i.responseType="blob",i.onload=({target:g})=>{if(g.status==200){const c=new Audio(URL.createObjectURL(g.response));c.addEventListener("canplay",()=>{c.addEventListener("canplaythrough",()=>{t.value===e&&(o&&(a.play(),c.play()),l.value=1)},{once:!0}),u.set(e,c),t.value===e&&(l.value=1),c.currentTime=a.currentTime},{once:!0}),c.load()}},i.send()}t.value=e},E=()=>{n&&(n.volume=_.value/100)};return R(()=>{const e=h.value;e.addEventListener("canplaythrough",()=>{e.controls=!0}),e.addEventListener("play",()=>{const o=u.get(t.value);o.volume=_.value/100,o.paused&&o.play(),n=o,d=!0}),e.addEventListener("pause",()=>{n&&n.pause(),d=!1}),e.addEventListener("ended",()=>{d=!1}),e.addEventListener("timeupdate",()=>{if(!n||Math.abs(e.currentTime-n.currentTime)<=.5)return;const o=d,a=t.value;e.pause(),n.pause(),n.addEventListener("canplaythrough",()=>{t.value===a&&o&&(e.play(),n.play())},{once:!0}),n.currentTime=e.currentTime}),e.load()}),(e,o)=>(v(),f(y,null,[A,B,s("div",F,[(v(!0),f(y,null,S(M(k),a=>(v(),f("div",{class:$(["flag-container mx-1 my-1",{"flag-container-active":t.value===a}]),key:a,onClick:i=>T(a)},[s("img",{class:"flag",src:`./assets/flags/${a}.svg`},null,8,D)],10,q))),128))]),s("div",O,[s("video",{ref_key:"videoRef",ref:h,class:"d-block z-0",muted:"",disableRemotePlayback:"",poster:P,preload:"auto",src:z},null,512),s("div",G,[s("span",H,b(t.value),1)]),l.value===-1?(v(),f("div",X,K)):L("",!0),l.value===0?(v(),f("div",Q,[s("div",W,[w("Loading "),s("span",Y,b(t.value),1),w("...")]),Z])):L("",!0)]),s("div",ee,[s("a",{class:"card p-2 me-2 mb-2 dl-btn",href:`./assets/firstencounter/languagetracks/languages/${t.value}.m4a`,role:"button",download:`firstencounter-${t.value}`},ae,8,se),s("div",ne,[oe,j(s("input",{type:"range",class:"form-range",min:"0",max:"100",step:"1","onUpdate:modelValue":o[0]||(o[0]=a=>_.value=a),onInput:E,style:{width:"200px"}},null,544),[[I,_.value]]),ie])]),le],64))}},de=V(re,[["__scopeId","data-v-7d0fb565"]]);export{de as default};
