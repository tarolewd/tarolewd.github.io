import{_ as M,r as h,m as V,q as R,o as f,c as p,a,F as w,s as S,f as C,t as L,b as k,w as U,j as $,x as j,n as q,p as A,g as I}from"./index-1a2a730a.js";const B=""+new URL("firstencounter/languagetracks/firstencounter-noaudio-poster.webp",import.meta.url).href,P=""+new URL("firstencounter/languagetracks/firstencounter-noaudio.mp4",import.meta.url).href;const l=_=>(A("data-v-f9c0a609"),_=_(),I(),_),z=l(()=>a("div",{class:"fs-3 text-light"},"First Encounter",-1)),D=l(()=>a("div",{class:"fs-4"},"Language Tracks",-1)),F={class:"d-flex flex-row justify-content-center flex-wrap my-1",style:{"margin-right":"-0.25rem !important","margin-left":"-0.25rem !important"}},N=["onClick"],O=["src"],G={class:"video-container"},H={class:"language-name-container"},Q={key:0,class:"video-container-overlay"},X=l(()=>a("div",{class:"fs-4 mt-5"},"Select a language.",-1)),J=[X],K={key:1,class:"video-container-overlay"},W={class:"fs-4 my-5"},Y=l(()=>a("div",{class:"spinner-border"},null,-1)),Z={class:"mt-2 d-flex flex-row justify-content-center"},ee=["href","download"],ae=l(()=>a("i",{class:"bi bi-download"},null,-1)),te=[ae],se={class:"card p-2 mb-2 d-flex flex-row"},ne=l(()=>a("span",{class:"me-1 icon-vol"},[a("i",{class:"bi bi-volume-off-fill"})],-1)),ie=l(()=>a("span",{class:"ms-1 icon-vol"},[a("i",{class:"bi bi-volume-up-fill"})],-1)),oe=j('<div class="text-center" style="font-size:0.8rem;" data-v-f9c0a609><div class="alert alert-success d-inline-flex mt-2 p-2" data-v-f9c0a609><div class="me-2" data-v-f9c0a609><i class="bi bi-exclamation-circle-fill" data-v-f9c0a609></i></div><div class="flex-grow-1 text-start" data-v-f9c0a609>The audio can be slightly offset depending on the device you are using. May not work properly on iOS. </div></div></div>',1),re={__name:"LanguageTracks",setup(_){const y=h(null),t=h(null),m=h(50),r=h(-1);let u=!1,n=null;const c=new Map,v=new Map,x=["english","german","japanese","swedish","french","portuguese","spanish","dutch","egyptian_arabic","bulgarian","croatian","danish","korean","finnish","norwegian","hungarian","icelandic","italian","chinese","russian","slovak","taiwanese","tamil","telugu","ukrainian","qatar_arabic"].sort(),g=e=>e?e==="egyptian_arabic"?"Arabic (Egypt)":e==="qatar_arabic"?"Arabic (Qatar)":e==="chinese"?"Chinese (Standard Mandarin)":e==="taiwanese"?"Chinese (Taiwanese Mandarin)":`${e[0].toUpperCase()}${e.slice(1)}`:"",E=e=>{if(t.value===e)return;const o=u,s=y.value;if(s.pause(),n&&n.pause(),c.has(e)){const i=c.get(e);i.addEventListener("canplay",()=>{i.addEventListener("canplaythrough",()=>{t.value===e&&(o&&(s.play(),i.play()),r.value=1)},{once:!0}),c.set(e,i),t.value===e&&(r.value=1),i.currentTime=s.currentTime},{once:!0}),i.load()}else if(!v.has(e)){r.value=0;const i=new XMLHttpRequest;i.open("GET",`./assets/firstencounter/languagetracks/languages/${e}.m4a`,!0),i.responseType="blob",i.onload=({target:b})=>{if(b.status==200){const d=new Audio(URL.createObjectURL(b.response));d.addEventListener("canplay",()=>{d.addEventListener("canplaythrough",()=>{t.value===e&&(o&&(s.play(),d.play()),r.value=1)},{once:!0}),c.set(e,d),v.delete(e),t.value===e&&(r.value=1),d.currentTime=s.currentTime},{once:!0}),d.load()}},i.send(),v.set(e,i)}t.value=e},T=()=>{n&&(n.volume=m.value/100)};return V(()=>{const e=y.value;e.addEventListener("canplaythrough",()=>{e.controls=!0}),e.addEventListener("play",()=>{const o=c.get(t.value);o.volume=m.value/100,o.paused&&o.play(),n=o,u=!0}),e.addEventListener("pause",()=>{n&&n.pause(),u=!1}),e.addEventListener("ended",()=>{u=!1}),e.addEventListener("timeupdate",()=>{if(!n||Math.abs(e.currentTime-n.currentTime)<=.5)return;const o=u,s=t.value;e.pause(),n.pause(),n.addEventListener("canplaythrough",()=>{t.value===s&&o&&(e.play(),n.play())},{once:!0}),n.currentTime=e.currentTime}),e.load()}),R(()=>{v.forEach(e=>{e.abort()}),v.clear(),c.forEach(e=>{e.src=null}),c.clear()}),(e,o)=>(f(),p(w,null,[z,D,a("div",F,[(f(!0),p(w,null,S(C(x),s=>(f(),p("div",{class:q(["flag-container mx-1 my-1",{"flag-container-active":t.value===s}]),key:s,onClick:i=>E(s)},[a("img",{class:"flag",src:`./assets/flags/${s}.svg`},null,8,O)],10,N))),128))]),a("div",G,[a("video",{ref_key:"videoRef",ref:y,class:"d-block z-0",muted:"",disableRemotePlayback:"",poster:B,preload:"auto",src:P},null,512),a("div",H,L(g(t.value)),1),r.value===-1?(f(),p("div",Q,J)):k("",!0),r.value===0?(f(),p("div",K,[a("div",W,"Loading "+L(g(t.value))+"...",1),Y])):k("",!0)]),a("div",Z,[a("a",{class:"card p-2 me-2 mb-2 dl-btn",href:`./assets/firstencounter/languagetracks/languages/${t.value}.m4a`,role:"button",download:`firstencounter-${t.value}`},te,8,ee),a("div",se,[ne,U(a("input",{type:"range",class:"form-range",min:"0",max:"100",step:"1","onUpdate:modelValue":o[0]||(o[0]=s=>m.value=s),onInput:T,style:{width:"200px"}},null,544),[[$,m.value]]),ie])]),oe],64))}},le=M(re,[["__scopeId","data-v-f9c0a609"]]);export{le as default};
