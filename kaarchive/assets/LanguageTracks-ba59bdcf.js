import{_ as S,r as m,m as R,o as v,c as f,a as s,F as L,s as M,f as y,t as b,w as j,j as I,b as x,x as k,y as $,n as C,p as N,g as P}from"./index-8d4eb29e.js";const U=""+new URL("firstencounter/languagetracks/firstencounter-noaudio-poster.webp",import.meta.url).href;const l=p=>(N("data-v-9e79f04a"),p=p(),P(),p),A=l(()=>s("div",{class:"fs-3 text-light"},"First Encounter",-1)),B=l(()=>s("div",{class:"fs-4"},"Language Tracks",-1)),F={class:"d-flex flex-row justify-content-center flex-wrap my-1",style:{"margin-right":"-0.5rem !important","margin-left":"-0.5rem !important"}},q=["onClick"],z=["src"],D={class:"mt-2 d-flex flex-row justify-content-center flex-wrap"},O={class:"card p-2 me-2 mb-2 fw-bold language-name-container"},G={class:"language-name"},H=["href","download"],W=l(()=>s("i",{class:"bi bi-download"},null,-1)),X=[W],J={class:"card p-2 mb-2 d-flex flex-row"},K=l(()=>s("span",{class:"me-1 icon-vol"},[s("i",{class:"bi bi-volume-off-fill"})],-1)),Q=l(()=>s("span",{class:"ms-1 icon-vol"},[s("i",{class:"bi bi-volume-up-fill"})],-1)),Y={class:"video-container"},Z={key:0,class:"video-container-overlay"},ee=l(()=>s("div",{class:"fs-4 mt-5"},"Select a language.",-1)),se=[ee],te={key:1,class:"video-container-overlay"},ae={class:"fs-4 my-5"},ne={class:"language-name"},oe=l(()=>s("div",{class:"spinner-border"},null,-1)),ie=$('<div class="text-center" style="font-size:0.8rem;" data-v-9e79f04a><div class="alert alert-success d-inline-flex mt-2 p-2" data-v-9e79f04a><div class="me-2" data-v-9e79f04a><i class="bi bi-exclamation-circle-fill" data-v-9e79f04a></i></div><div class="flex-grow-1" data-v-9e79f04a>May not work properly on iOS.</div></div></div>',1),re={__name:"LanguageTracks",setup(p){const h=m(null),t=m("-"),_=m(50),r=m(-1);let d=!1,n=null;const u=new Map,T=new Set,g=["english","german","japanese","swedish","french"].sort(),E=e=>{if(t.value===e)return;const o=d,a=h.value;if(a.pause(),n&&n.pause(),u.has(e)){const i=u.get(e);i.addEventListener("canplay",()=>{i.addEventListener("canplaythrough",()=>{t.value===e&&(o&&(a.play(),i.play()),r.value=1)},{once:!0}),u.set(e,i),t.value===e&&(r.value=1),i.currentTime=a.currentTime},{once:!0}),i.load()}else if(!T.has(e)){r.value=0;const i=new XMLHttpRequest;i.open("GET",`./assets/firstencounter/languagetracks/languages/${e}.m4a`,!0),i.responseType="blob",i.onload=({target:w})=>{if(w.status==200){const c=new Audio(URL.createObjectURL(w.response));c.addEventListener("canplay",()=>{c.addEventListener("canplaythrough",()=>{t.value===e&&(o&&(a.play(),c.play()),r.value=1)},{once:!0}),u.set(e,c),t.value===e&&(r.value=1),c.currentTime=a.currentTime},{once:!0}),c.load()}},i.send()}t.value=e},V=()=>{n&&(n.volume=_.value/100)};return R(()=>{const e=h.value;window&&window.innerWidth>=992?e.src="./assets/firstencounter/languagetracks/firstencounter-noaudio-800.mp4":e.src="./assets/firstencounter/languagetracks/firstencounter-noaudio-540.mp4",e.addEventListener("canplaythrough",()=>{e.controls=!0}),e.addEventListener("play",()=>{const o=u.get(t.value);o.volume=_.value/100,o.paused&&o.play(),n=o,d=!0}),e.addEventListener("pause",()=>{n&&n.pause(),d=!1}),e.addEventListener("ended",()=>{d=!1}),e.addEventListener("timeupdate",()=>{if(!n||Math.abs(e.currentTime-n.currentTime)<=.5)return;const o=d,a=t.value;e.pause(),n.pause(),n.addEventListener("canplaythrough",()=>{t.value===a&&o&&(e.play(),n.play())},{once:!0}),n.currentTime=e.currentTime}),e.load()}),(e,o)=>(v(),f(L,null,[A,B,s("div",F,[(v(!0),f(L,null,M(y(g),a=>(v(),f("div",{class:C(["flag-container mx-2 my-1",{"flag-container-active":t.value===a}]),key:a,onClick:i=>E(a)},[s("img",{class:"flag",src:`./assets/flags/${a}.svg`},null,8,z)],10,q))),128))]),s("div",D,[s("div",O,[s("span",G,b(t.value),1)]),s("a",{class:"card p-2 me-2 mb-2 dl-btn",href:`./assets/firstencounter/languagetracks/languages/${y(g)[t.value]}.m4a`,role:"button",download:`firstencounter-${y(g)[t.value]}`},X,8,H),s("div",J,[K,j(s("input",{type:"range",class:"form-range",min:"0",max:"100",step:"1","onUpdate:modelValue":o[0]||(o[0]=a=>_.value=a),onInput:V,style:{width:"200px"}},null,544),[[I,_.value]]),Q])]),s("div",Y,[s("video",{ref_key:"videoRef",ref:h,muted:"",disableRemotePlayback:"",poster:U,preload:"auto"},null,512),r.value===-1?(v(),f("div",Z,se)):x("",!0),r.value===0?(v(),f("div",te,[s("div",ae,[k("Loading "),s("span",ne,b(t.value),1),k("...")]),oe])):x("",!0)]),ie],64))}},ce=S(re,[["__scopeId","data-v-9e79f04a"]]);export{ce as default};
