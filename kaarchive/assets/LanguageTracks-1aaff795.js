import{_ as V,r as h,m as R,q as M,o as p,c as f,a as t,F as L,s as S,f as U,t as w,b as x,w as $,j,x as C,n as I,p as A,g as B}from"./index-9fcca5b2.js";const P=""+new URL("firstencounter/languagetracks/firstencounter-noaudio-poster.webp",import.meta.url).href,q=""+new URL("firstencounter/languagetracks/firstencounter-noaudio.mp4",import.meta.url).href;const c=_=>(A("data-v-7e733860"),_=_(),B(),_),z=c(()=>t("div",{class:"fs-3 text-light"},"First Encounter",-1)),D=c(()=>t("div",{class:"fs-4"},"Language Tracks",-1)),F={class:"d-flex flex-row justify-content-center flex-wrap my-1",style:{"margin-right":"-0.25rem !important","margin-left":"-0.25rem !important"}},N=["onClick"],O=["src"],G={class:"video-container"},H={class:"language-name-container"},X={key:0,class:"video-container-overlay"},J=c(()=>t("div",{class:"fs-4 mt-5"},"Select a language.",-1)),K=[J],Q={key:1,class:"video-container-overlay"},W={class:"fs-4 my-5"},Y=c(()=>t("div",{class:"spinner-border"},null,-1)),Z={class:"mt-2 d-flex flex-row justify-content-center"},ee=["href","download"],te=c(()=>t("i",{class:"bi bi-download"},null,-1)),se=[te],ae={class:"card p-2 mb-2 d-flex flex-row"},ne=c(()=>t("span",{class:"me-1 icon-vol"},[t("i",{class:"bi bi-volume-off-fill"})],-1)),oe=c(()=>t("span",{class:"ms-1 icon-vol"},[t("i",{class:"bi bi-volume-up-fill"})],-1)),ie=C('<div class="text-center" style="font-size:0.8rem;" data-v-7e733860><div class="alert alert-success d-inline-flex mt-2 p-2" data-v-7e733860><div class="me-2" data-v-7e733860><i class="bi bi-exclamation-circle-fill" data-v-7e733860></i></div><div class="flex-grow-1 text-start" data-v-7e733860>The audio can be slightly offset depending on the device you are using. May not work properly on iOS. </div></div></div>',1),re={__name:"LanguageTracks",setup(_){const y=h(null),s=h(null),m=h(50),r=h(-1);let u=!1,n=null;const l=new Map,v=new Map,k=["english","german","japanese","swedish","french","portuguese","spanish","dutch","egyptian","bulgarian","croatian","danish","korean","finnish","norwegian"].sort(),g=e=>e?e==="egyptian"?"Egyptian (Arabic)":`${e[0].toUpperCase()}${e.slice(1)}`:"",E=e=>{if(s.value===e)return;const i=u,a=y.value;if(a.pause(),n&&n.pause(),l.has(e)){const o=l.get(e);o.addEventListener("canplay",()=>{o.addEventListener("canplaythrough",()=>{s.value===e&&(i&&(a.play(),o.play()),r.value=1)},{once:!0}),l.set(e,o),s.value===e&&(r.value=1),o.currentTime=a.currentTime},{once:!0}),o.load()}else if(!v.has(e)){r.value=0;const o=new XMLHttpRequest;o.open("GET",`./assets/firstencounter/languagetracks/languages/${e}.m4a`,!0),o.responseType="blob",o.onload=({target:b})=>{if(b.status==200){const d=new Audio(URL.createObjectURL(b.response));d.addEventListener("canplay",()=>{d.addEventListener("canplaythrough",()=>{s.value===e&&(i&&(a.play(),d.play()),r.value=1)},{once:!0}),l.set(e,d),v.delete(e),s.value===e&&(r.value=1),d.currentTime=a.currentTime},{once:!0}),d.load()}},o.send(),v.set(e,o)}s.value=e},T=()=>{n&&(n.volume=m.value/100)};return R(()=>{const e=y.value;e.addEventListener("canplaythrough",()=>{e.controls=!0}),e.addEventListener("play",()=>{const i=l.get(s.value);i.volume=m.value/100,i.paused&&i.play(),n=i,u=!0}),e.addEventListener("pause",()=>{n&&n.pause(),u=!1}),e.addEventListener("ended",()=>{u=!1}),e.addEventListener("timeupdate",()=>{if(!n||Math.abs(e.currentTime-n.currentTime)<=.5)return;const i=u,a=s.value;e.pause(),n.pause(),n.addEventListener("canplaythrough",()=>{s.value===a&&i&&(e.play(),n.play())},{once:!0}),n.currentTime=e.currentTime}),e.load()}),M(()=>{v.forEach(e=>{e.abort()}),v.clear(),l.forEach(e=>{e.src=null}),l.clear()}),(e,i)=>(p(),f(L,null,[z,D,t("div",F,[(p(!0),f(L,null,S(U(k),a=>(p(),f("div",{class:I(["flag-container mx-1 my-1",{"flag-container-active":s.value===a}]),key:a,onClick:o=>E(a)},[t("img",{class:"flag",src:`./assets/flags/${a}.svg`},null,8,O)],10,N))),128))]),t("div",G,[t("video",{ref_key:"videoRef",ref:y,class:"d-block z-0",muted:"",disableRemotePlayback:"",poster:P,preload:"auto",src:q},null,512),t("div",H,w(g(s.value)),1),r.value===-1?(p(),f("div",X,K)):x("",!0),r.value===0?(p(),f("div",Q,[t("div",W,"Loading "+w(g(s.value))+"...",1),Y])):x("",!0)]),t("div",Z,[t("a",{class:"card p-2 me-2 mb-2 dl-btn",href:`./assets/firstencounter/languagetracks/languages/${s.value}.m4a`,role:"button",download:`firstencounter-${s.value}`},se,8,ee),t("div",ae,[ne,$(t("input",{type:"range",class:"form-range",min:"0",max:"100",step:"1","onUpdate:modelValue":i[0]||(i[0]=a=>m.value=a),onInput:T,style:{width:"200px"}},null,544),[[j,m.value]]),oe])]),ie],64))}},ce=V(re,[["__scopeId","data-v-7e733860"]]);export{ce as default};
