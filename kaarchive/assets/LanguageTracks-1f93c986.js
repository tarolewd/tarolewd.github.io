import{_ as V,r as m,m as R,o as v,c as f,a as s,F as y,s as S,f as M,t as L,w as j,j as I,b as w,x as b,y as U,n as $,p as C,g as N}from"./index-e723c2f2.js";const P=""+new URL("firstencounter/languagetracks/firstencounter-noaudio-poster.webp",import.meta.url).href,A=""+new URL("firstencounter/languagetracks/firstencounter-noaudio.mp4",import.meta.url).href;const l=p=>(C("data-v-3e16a2df"),p=p(),N(),p),B=l(()=>s("div",{class:"fs-3 text-light"},"First Encounter",-1)),F=l(()=>s("div",{class:"fs-4"},"Language Tracks",-1)),q={class:"d-flex flex-row justify-content-center flex-wrap my-1",style:{"margin-right":"-0.5rem !important","margin-left":"-0.5rem !important"}},z=["onClick"],D=["src"],O={class:"mt-2 d-flex flex-row justify-content-center flex-wrap"},G={class:"card p-2 me-2 mb-2 fw-bold language-name-container"},H={class:"language-name"},X=["href","download"],J=l(()=>s("i",{class:"bi bi-download"},null,-1)),K=[J],Q={class:"card p-2 mb-2 d-flex flex-row"},W=l(()=>s("span",{class:"me-1 icon-vol"},[s("i",{class:"bi bi-volume-off-fill"})],-1)),Y=l(()=>s("span",{class:"ms-1 icon-vol"},[s("i",{class:"bi bi-volume-up-fill"})],-1)),Z={class:"video-container"},ee={key:0,class:"video-container-overlay"},se=l(()=>s("div",{class:"fs-4 mt-5"},"Select a language.",-1)),te=[se],ae={key:1,class:"video-container-overlay"},ne={class:"fs-4 my-5"},oe={class:"language-name"},ie=l(()=>s("div",{class:"spinner-border"},null,-1)),re=U('<div class="text-center" style="font-size:0.8rem;" data-v-3e16a2df><div class="alert alert-success d-inline-flex mt-2 p-2" data-v-3e16a2df><div class="me-2" data-v-3e16a2df><i class="bi bi-exclamation-circle-fill" data-v-3e16a2df></i></div><div class="flex-grow-1" data-v-3e16a2df>May not work properly on iOS.</div></div></div>',1),le={__name:"LanguageTracks",setup(p){const h=m(null),t=m("-"),_=m(50),r=m(-1);let d=!1,n=null;const u=new Map,x=new Set,k=["english","german","japanese","swedish","french"].sort(),T=e=>{if(t.value===e)return;const o=d,a=h.value;if(a.pause(),n&&n.pause(),u.has(e)){const i=u.get(e);i.addEventListener("canplay",()=>{i.addEventListener("canplaythrough",()=>{t.value===e&&(o&&(a.play(),i.play()),r.value=1)},{once:!0}),u.set(e,i),t.value===e&&(r.value=1),i.currentTime=a.currentTime},{once:!0}),i.load()}else if(!x.has(e)){r.value=0;const i=new XMLHttpRequest;i.open("GET",`./assets/firstencounter/languagetracks/languages/${e}.m4a`,!0),i.responseType="blob",i.onload=({target:g})=>{if(g.status==200){const c=new Audio(URL.createObjectURL(g.response));c.addEventListener("canplay",()=>{c.addEventListener("canplaythrough",()=>{t.value===e&&(o&&(a.play(),c.play()),r.value=1)},{once:!0}),u.set(e,c),t.value===e&&(r.value=1),c.currentTime=a.currentTime},{once:!0}),c.load()}},i.send()}t.value=e},E=()=>{n&&(n.volume=_.value/100)};return R(()=>{const e=h.value;e.addEventListener("canplaythrough",()=>{e.controls=!0}),e.addEventListener("play",()=>{const o=u.get(t.value);o.volume=_.value/100,o.paused&&o.play(),n=o,d=!0}),e.addEventListener("pause",()=>{n&&n.pause(),d=!1}),e.addEventListener("ended",()=>{d=!1}),e.addEventListener("timeupdate",()=>{if(!n||Math.abs(e.currentTime-n.currentTime)<=.5)return;const o=d,a=t.value;e.pause(),n.pause(),n.addEventListener("canplaythrough",()=>{t.value===a&&o&&(e.play(),n.play())},{once:!0}),n.currentTime=e.currentTime}),e.load()}),(e,o)=>(v(),f(y,null,[B,F,s("div",q,[(v(!0),f(y,null,S(M(k),a=>(v(),f("div",{class:$(["flag-container mx-2 my-1",{"flag-container-active":t.value===a}]),key:a,onClick:i=>T(a)},[s("img",{class:"flag",src:`./assets/flags/${a}.svg`},null,8,D)],10,z))),128))]),s("div",O,[s("div",G,[s("span",H,L(t.value),1)]),s("a",{class:"card p-2 me-2 mb-2 dl-btn",href:`./assets/firstencounter/languagetracks/languages/${t.value}.m4a`,role:"button",download:`firstencounter-${t.value}`},K,8,X),s("div",Q,[W,j(s("input",{type:"range",class:"form-range",min:"0",max:"100",step:"1","onUpdate:modelValue":o[0]||(o[0]=a=>_.value=a),onInput:E,style:{width:"200px"}},null,544),[[I,_.value]]),Y])]),s("div",Z,[s("video",{ref_key:"videoRef",ref:h,muted:"",disableRemotePlayback:"",poster:P,preload:"auto",src:A},null,512),r.value===-1?(v(),f("div",ee,te)):w("",!0),r.value===0?(v(),f("div",ae,[s("div",ne,[b("Loading "),s("span",oe,L(t.value),1),b("...")]),ie])):w("",!0)]),re],64))}},de=V(le,[["__scopeId","data-v-3e16a2df"]]);export{de as default};
